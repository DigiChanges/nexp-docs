"use strict";(self.webpackChunknexp_docs=self.webpackChunknexp_docs||[]).push([[3752],{2618:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>s,metadata:()=>r,toc:()=>l});var i=t(5893),o=t(1151);const s={},c="Dependency Injection",r={id:"documentation/dependency-injection",title:"Dependency Injection",description:"In this section we will explain how dependency injection works in NExp.",source:"@site/docs/documentation/12-dependency-injection.md",sourceDirName:"documentation",slug:"/documentation/dependency-injection",permalink:"/docs/documentation/dependency-injection",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:12,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Dotenv, envalid and config",permalink:"/docs/documentation/dotenv"},next:{title:"RequestID",permalink:"/docs/documentation/request-id"}},a={},l=[];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",p:"p",pre:"pre",...(0,o.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"dependency-injection",children:"Dependency Injection"}),"\n",(0,i.jsx)(n.p,{children:"In this section we will explain how dependency injection works in NExp."}),"\n",(0,i.jsxs)(n.p,{children:["We are currently using ",(0,i.jsx)(n.a,{href:"https://github.com/Microsoft/tsyringe",children:"tsyringe"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"It is this file that records all the dependencies."}),"\n",(0,i.jsxs)(n.p,{children:["In this case what we do is add a concrete class of the ",(0,i.jsx)(n.code,{children:"Repository"})," with its corresponding specification,\nWe also tell you what its life cycle would be. In the case of repositories, the correct thing is that it be ",(0,i.jsx)(n.code,{children:"ContainerScoped"}),",\nthis is so it does a new for each request. Therefore, in a request if we are going to call in several parts the\nrepository we would be saving resources since we would not be creating it in each call."]}),"\n",(0,i.jsx)(n.p,{children:"On the other hand we have classes that work as singletons, this is done in this way since they do not participate much\nin each request."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"/** src -> register.ts **/\n\nif (defaultDbConfig === 'TypeORM')\n{\n    container.register<IUserRepository>(REPOSITORIES.IUserRepository, { useClass: UserTypeORMRepository }, { lifecycle: Lifecycle.ContainerScoped });\n    container.register<IRoleRepository>(REPOSITORIES.IRoleRepository, { useClass: RoleTypeORMRepository }, { lifecycle: Lifecycle.ContainerScoped });\n    container.register<IItemRepository>(REPOSITORIES.IItemRepository, { useClass: ItemTypeORMRepository }, { lifecycle: Lifecycle.ContainerScoped });\n    container.register<IFileRepository>(REPOSITORIES.IFileRepository, { useClass: FileTypeORMRepository }, { lifecycle: Lifecycle.ContainerScoped });\n}\n\n// ...\n\n// Shared\ncontainer.register<IEncryption>(FACTORIES.BcryptEncryptionStrategy, { useClass: BcryptEncryptionStrategy }, { lifecycle: Lifecycle.Singleton });\ncontainer.register<IEncryption>(FACTORIES.Md5EncryptionStrategy, { useClass: Md5EncryptionStrategy }, { lifecycle: Lifecycle.Singleton });\n\n"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["As dependencies, we have ",(0,i.jsx)(n.a,{href:"https://github.com/inversify/InversifyJS",children:"inversify"}),", we used this library before to\nthe whole project, but now it's in a phase-out process. It is a necessary dependency to use ",(0,i.jsx)(n.code,{children:"express"}),". But\nover time we will end up eliminating it, and we will be using ",(0,i.jsx)(n.code,{children:"express"})," as we do with ",(0,i.jsx)(n.code,{children:"koa"}),"."]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>r,a:()=>c});var i=t(7294);const o={},s=i.createContext(o);function c(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);